import{d as B,r as u,n as x,q as w,C as E,s as Q,t as V,c as d,w as o,a as n,b as l,e as r,x as D,y as N,z as g,h as L,f as _,A as C,B as f,D as z,F,I as q,E as O,G as p,j as T,l as A,H as P,J as R,K as W}from"./index-DSmeTysl.js";import{_ as j}from"./HeaderToolBar.vue_vue_type_script_setup_true_lang-DwM70x0L.js";import"./bcbplogo-DPdg0dlV.js";const G={style:{"font-size":"12px",color:"#a8a8a8"}},J={key:0,class:"song-artist"},K={key:1,class:"no-result"},M={key:0,class:"no-result-content"},$=_("h1",null,"No Result Found",-1),U=_("span",null,"We couldn't find any title, lyrics or artist matching your search",-1),te=B({__name:"SongListPage",setup(X){const v=u(!1),I=e=>{e.detail.scrollTop>30?v.value=!0:v.value=!1},c=u(P),i=u(w);x(async()=>{var a,t;i.value=new w(E);const e=await i.value.checkConnectionsConsistency(),s=(await i.value.isConnection("db_songlist",!1)).result;e.result&&s?c.value=await((a=i.value)==null?void 0:a.retrieveConnection("db_songlist",!1)):c.value=await((t=i.value)==null?void 0:t.createConnection("db_songlist",!1,"no-encryption",1,!1)),S()}),Q(async()=>{var e;await((e=i.value)==null?void 0:e.closeConnection("db_songlist",!1))});const S=async()=>{var s,a,t;await((s=c.value)==null?void 0:s.open());const e=await((a=c.value)==null?void 0:a.query("SELECT * FROM songs"));await((t=c.value)==null?void 0:t.close()),m.value=e==null?void 0:e.values},m=u(),h=u(""),k=e=>{h.value=e.searchQuery},b=e=>{var s;return(s=m.value)==null?void 0:s.filter(a=>{var t;return a.title.toLowerCase().includes(e)||a.lyrics.toLowerCase().includes(e)||((t=a.artist)==null?void 0:t.toLowerCase().includes(e))}).sort((a,t)=>a.title.localeCompare(t.title))},y=V(()=>b(h.value.toLocaleLowerCase()));return(e,s)=>(l(),d(n(A),null,{default:o(()=>[r(j,{onEmitSearch:k,isHeaderHidden:v.value},null,8,["isHeaderHidden"]),r(n(T),{fullscreen:!0,onIonScroll:s[0]||(s[0]=a=>I(a)),"scroll-events":!0},{default:o(()=>{var a;return[((a=y.value)==null?void 0:a.length)>0?(l(),d(n(D),{key:0},{default:o(()=>[r(n(N),null,{default:o(()=>[r(n(g),{class:"list-header"},{default:o(()=>[L("Songs "),_("span",G,"["+C(y.value.length)+"]",1)]),_:1})]),_:1}),(l(!0),f(F,null,z(y.value,(t,H)=>(l(),d(n(R),{key:"song_"+H,href:"/song/"+t.id+"/lyrics"},{default:o(()=>[r(n(g),{class:"fade-in-left-animation song-label"},{default:o(()=>[_("p",null,C(t.title),1),t.artist?(l(),f("span",J,C(t.artist),1)):p("",!0)]),_:2},1024),t.chords?(l(),d(n(W),{key:0,slot:"end",size:"small",fill:"outline",color:"warning",href:"/song/"+t.id+"/chords"},{default:o(()=>[L("chords ")]),_:2},1032,["href"])):p("",!0)]),_:2},1032,["href"]))),128))]),_:1})):(l(),f("div",K,[h.value?(l(),f("div",M,[r(n(q),{icon:n(O),size:"large"},null,8,["icon"]),$,U])):p("",!0)]))]}),_:1})]),_:1}))}});export{te as default};
