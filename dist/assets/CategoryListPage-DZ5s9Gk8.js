import{_ as N}from"./HeaderToolBar.vue_vue_type_script_setup_true_lang-BlGo9qvC.js";import{d as z,r as d,t as F,n as j,q as b,C as q,s as O,c as C,w as r,a as o,b as a,e as f,B as c,F as H,D as S,I as T,E as A,G as p,j as P,l as R,f as m,H as W,x as G,y as J,z as x,h as B,A as w,J as K,K as M}from"./index-BV0GmIU9.js";import"./bcbplogo-DPdg0dlV.js";const $={key:0},U={style:{"font-size":"12px",color:"#a8a8a8"}},X={key:0,class:"song-artist"},Y={key:1,class:"no-result"},Z={key:0,class:"no-result-content"},ee=m("h1",null,"No Result Found",-1),se=m("span",null,"We couldn't find any title, lyrics or artist matching your search",-1),ie=z({__name:"CategoryListPage",setup(te){const L=d(!1),E=e=>{e.detail.scrollTop>30?L.value=!0:L.value=!1},h=d(),I=d(),g=d(""),Q=e=>{g.value=e.searchQuery},V=(e,n)=>e==null?void 0:e.map(t=>({...t,songs:t.songs.filter(s=>{var l;return s.category.toLowerCase().includes(n)||s.title.toLowerCase().includes(n)||s.lyrics.toLowerCase().includes(n)||((l=s.artist)==null?void 0:l.toLowerCase().includes(n))}).sort((s,l)=>s.title.localeCompare(l.title))})),k=F(()=>V(I.value,g.value.toLowerCase())),_=d(W),u=d(b);j(async()=>{var t,s;u.value=new b(q);const e=await u.value.checkConnectionsConsistency(),n=(await u.value.isConnection("db_songlist",!1)).result;e.result&&n?_.value=await((t=u.value)==null?void 0:t.retrieveConnection("db_songlist",!1)):_.value=await((s=u.value)==null?void 0:s.createConnection("db_songlist",!1,"no-encryption",1,!1)),D()}),O(async()=>{var e;g.value="",await((e=u.value)==null?void 0:e.closeConnection("db_songlist",!1))});const D=async()=>{var s,l,i;await((s=_.value)==null?void 0:s.open());const e=await((l=_.value)==null?void 0:l.query("SELECT * FROM songs"));await((i=_.value)==null?void 0:i.close()),h.value=e==null?void 0:e.values;const t=await(await fetch("/category.json")).json();I.value=t.categories,I.value.forEach(v=>{v.songs=[];for(let y=0;y<h.value.length;y++)h.value[y].category==v.category&&v.songs.push(h.value[y])}),console.log(k.value)};return(e,n)=>(a(),C(o(R),null,{default:r(()=>[f(N,{onEmitSearch:Q,isHeaderHidden:L.value},null,8,["isHeaderHidden"]),f(o(P),{fullscreen:!0,onIonScroll:n[0]||(n[0]=t=>E(t)),"scroll-events":!0},{default:r(()=>{var t;return[((t=k.value)==null?void 0:t.length)>0?(a(),c("div",$,[(a(!0),c(H,null,S(k.value,(s,l)=>(a(),c("div",{key:"category_"+l},[s.songs.length>0?(a(),C(o(G),{key:0,lines:"inset"},{default:r(()=>[f(o(J),null,{default:r(()=>[f(o(x),{class:"list-header"},{default:r(()=>[B(w(s.name)+" ",1),m("span",U,"["+w(s.songs.length)+"]",1)]),_:2},1024)]),_:2},1024),(a(!0),c(H,null,S(s.songs,(i,v)=>(a(),C(o(K),{key:"song_"+v,href:"/song/"+i.id+"/lyrics"},{default:r(()=>[f(o(x),{class:"fade-in-left-animation song-label"},{default:r(()=>[m("p",null,w(i.title),1),i.artist?(a(),c("span",X,w(i.artist),1)):p("",!0)]),_:2},1024),i.chords?(a(),C(o(M),{key:0,slot:"end",size:"small",fill:"outline",color:"warning",href:"/song/"+i.id+"/chords"},{default:r(()=>[B("chords ")]),_:2},1032,["href"])):p("",!0)]),_:2},1032,["href"]))),128))]),_:2},1024)):p("",!0)]))),128))])):(a(),c("div",Y,[g.value?(a(),c("div",Z,[f(o(T),{icon:o(A),size:"large"},null,8,["icon"]),ee,se])):p("",!0)]))]}),_:1})]),_:1}))}});export{ie as default};
