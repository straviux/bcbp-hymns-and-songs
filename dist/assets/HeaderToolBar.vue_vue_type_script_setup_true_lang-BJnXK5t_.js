import{d as C,b as w,c as I,w as s,e,a as t,L,I as d,M as R,N as T,h as u,O as z,J as m,P as Z,j as B,f as a,Q as x,R as K,r as M,E as H,T as W,U as X,x as Y,D as G,q as Q,C as tt,S as et,V as st,W as at,X as nt,Y as ot,Z as A,$ as lt,a0 as it}from"./index-B5KLrix8.js";import{_ as ct}from"./bcbplogo-DPdg0dlV.js";const rt="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20308.19%20305.67'%3e%3cdefs%3e%3cstyle%3e.cls-1,.cls-2{fill:%2302208b;}.cls-2{fill-rule:evenodd;}%3c/style%3e%3c/defs%3e%3ctitle%3ebcbp-seeklogo%3c/title%3e%3cg%20id='center_line_with_3_circles'%20data-name='center%20line%20with%203%20circles'%3e%3ccircle%20class='cls-1'%20cx='101.06'%20cy='84'%20r='23.17'/%3e%3ccircle%20class='cls-1'%20cx='207.06'%20cy='84'%20r='23.17'/%3e%3ccircle%20class='cls-1'%20cx='154.06'%20cy='26.5'%20r='26.5'/%3e%3crect%20class='cls-1'%20x='127.56'%20y='60.83'%20width='53'%20height='244.83'/%3e%3c/g%3e%3cg%20id='inner_component_cutouts'%20data-name='inner%20component%20cutouts'%3e%3cpath%20class='cls-1'%20d='M332.7,164.58a33.08,33.08,0,0,1,0,46.34h77.43a159.88,159.88,0,0,0-22.19-46.34Z'%20transform='translate(-101.94%20-103.75)'/%3e%3cpath%20class='cls-1'%20d='M169.58,187.5a33.07,33.07,0,0,1,9.47-23.17H124.23a160.26,160.26,0,0,0-22.29,46.34h77.11A33.07,33.07,0,0,1,169.58,187.5Z'%20transform='translate(-101.94%20-103.75)'/%3e%3cpolygon%20class='cls-2'%20points='117.81%20114.33%2075.93%20114.33%2050.43%20158.83%2092.31%20158.83%20117.81%20114.33'/%3e%3cpolygon%20class='cls-2'%20points='117.81%20203.33%2075.93%20203.33%2050.43%20158.83%2092.31%20158.83%20117.81%20203.33'/%3e%3cpolygon%20class='cls-2'%20points='189.35%20114.33%20231.22%20114.33%20256.72%20158.83%20214.85%20158.83%20189.35%20114.33'/%3e%3cpolygon%20class='cls-2'%20points='189.35%20203.33%20231.22%20203.33%20256.72%20158.83%20214.85%20158.83%20189.35%20203.33'/%3e%3c/g%3e%3c/svg%3e",dt=a("div",{class:"ion-padding"},[a("div",{class:"settings-content"},"Coming soon..")],-1),ut=C({__name:"SettingsModal",setup(p){const n=()=>x.dismiss(null,"cancel");return(l,r)=>(w(),I(t(B),{class:"settings-modal"},{default:s(()=>[e(t(L),null,{default:s(()=>[e(t(d),{icon:t(R),style:{"margin-left":"10px","margin-right":"-10px","font-size":"22px"},slot:"start"},null,8,["icon"]),e(t(T),null,{default:s(()=>[u("Settings")]),_:1}),e(t(z),{slot:"end"},{default:s(()=>[e(t(m),{color:"light",onClick:n},{default:s(()=>[e(t(d),{icon:t(Z)},null,8,["icon"])]),_:1})]),_:1})]),_:1}),dt]),_:1}))}}),pt=a("div",{class:"ion-padding"},[a("div",{class:"update-library-content"},[a("div",{class:"indicator"},[a("div",null,"Updating library...")])])],-1),_t=C({__name:"UpdateLibraryModal",setup(p){return(n,l)=>(w(),I(t(B),null,{default:s(()=>[pt,e(t(K),{type:"indeterminate",color:"success"})]),_:1}))}}),ft=a("div",{class:"ion-padding",style:{color:"#555",display:"flex","flex-direction":"column",gap:"8px"}},[a("img",{src:ct,alt:"bcbp logo",height:"160",width:"160",style:{margin:"auto"}}),a("div",{style:{margin:"auto"}},[a("h4",null,"BCBP Hyms & Songs"),a("div",{style:{"font-size":"12px",color:"#777","margin-top":"10px"}},[a("span",null,"Version 1.1")]),a("div",{style:{"font-size":"12px",color:"#777","margin-top":"10px"}},[u(" Last library update: "),a("span",null,"04/08/2024")])])],-1),gt=C({__name:"AboutModal",setup(p){const n=()=>x.dismiss(null,"cancel");return(l,r)=>(w(),I(t(B),{class:"about-modal"},{default:s(()=>[e(t(L),null,{default:s(()=>[e(t(T),null,{default:s(()=>[u("About")]),_:1}),e(t(z),{slot:"end"},{default:s(()=>[e(t(m),{color:"light",onClick:n},{default:s(()=>[e(t(d),{icon:t(Z)},null,8,["icon"])]),_:1})]),_:1})]),_:1}),ft]),_:1}))}}),mt=C({__name:"MenuList",setup(p){const n=M(G),l=M(Q),r=async c=>{const o={component:gt,cssClass:"about-modal"},_={component:_t,cssClass:"update-library-modal"},f={component:ut,cssClass:"settings-modal"},i=await x.create(o),y=await x.create(_),F=await x.create(f);if(c=="settings"&&F.present(),c=="update"){y.present().then(async()=>{var v,h;l.value=new Q(tt);const b=await l.value.checkConnectionsConsistency(),$=(await l.value.isConnection("db_songlist",!1)).result;b.result&&$?n.value=await((v=l.value)==null?void 0:v.retrieveConnection("db_songlist",!1)):n.value=await((h=l.value)==null?void 0:h.createConnection("db_songlist",!1,"no-encryption",1,!1)),J()});const J=async()=>{var O,E;const b=new et;await b.create();const $=await b.get("last-library-update");let v="Library is already up to date";await((O=n.value)==null?void 0:O.open());const h=await((E=n.value)==null?void 0:E.query("SELECT COUNT(*) as song_count FROM songs"));console.log("res: ".concat(JSON.stringify(h.values[0].song_count))),await st.get("/api/songs").then(S=>{var V,q;const U=S.data.data,P=S.data.last_update;if($!=P||parseInt(h.values[0].song_count)!==parseInt(U.length)){let k=null;(V=n.value)==null||V.query("DELETE FROM songs"),U.forEach(g=>{var N;try{k=P,(N=n.value)==null||N.query("INSERT INTO songs (id,title,lyrics,chords,artist,category) values (?,?,?,?,?,?)",[g.id,g.title,g.lyrics,g.chords,g.artist,g.category]),v="Library has been updated"}catch(j){k=null,alert(j)}}),b.set("last-library-update",k),(q=n.value)==null||q.close()}}),y.dismiss();const D=await at.create({message:v,duration:3e3,cssClass:"custom-toast",position:"bottom"});D.present(),D.onDidDismiss().then(S=>{S.role&&window.location.reload()})}}c=="about"&&i.present()};return(c,o)=>(w(),I(t(B),null,{default:s(()=>[e(t(Y),{lines:"full"},{default:s(()=>[e(t(H),{button:"",onClick:o[0]||(o[0]=_=>r("settings"))},{default:s(()=>[e(t(m),{fill:"clear",expand:"block",style:{color:"#777","text-transform":"capitalize","font-size":"14px",padding:"10px 0"}},{default:s(()=>[e(t(d),{slot:"start",icon:t(R)},null,8,["icon"]),u(" Settings ")]),_:1})]),_:1}),e(t(H),{button:"",onClick:o[1]||(o[1]=_=>r("update"))},{default:s(()=>[e(t(m),{fill:"clear",expand:"block",style:{color:"#777","text-transform":"capitalize","font-size":"14px",padding:"10px 0"}},{default:s(()=>[e(t(d),{slot:"start",icon:t(W)},null,8,["icon"]),u(" Update Library ")]),_:1})]),_:1}),e(t(H),{lines:"none",button:"",onClick:o[2]||(o[2]=_=>r("about"))},{default:s(()=>[e(t(m),{fill:"clear",expand:"block",style:{color:"#777","text-transform":"capitalize","font-size":"14px",padding:"10px 0"}},{default:s(()=>[e(t(d),{slot:"start",icon:t(X)},null,8,["icon"]),u(" About ")]),_:1})]),_:1})]),_:1})]),_:1}))}}),yt=a("img",{src:rt,height:"40",slot:"start",style:{"margin-left":"14px","margin-right":"-10px"}},null,-1),ht=C({__name:"HeaderToolBar",props:{isHeaderHidden:{type:Boolean,default:!1}},emits:["emitSearch"],setup(p,{emit:n}){const l=n,r=()=>{var i;const f=(i=document.querySelector("#searchbar"))==null?void 0:i.value;l("emitSearch",{searchQuery:f})},c=M(!1),o=M(),_=f=>{o.value=f,c.value=!0};return(f,i)=>(w(),I(t(it),{class:"ion-no-border"},{default:s(()=>[e(t(L),{class:A(["header-transition",{"ion-header-hidden":p.isHeaderHidden}])},{default:s(()=>[yt,e(t(T),null,{default:s(()=>[u("BCBP Hymns & Songs")]),_:1}),e(t(z),{slot:"primary"},{default:s(()=>[e(t(m),{onClick:i[0]||(i[0]=y=>_(y))},{default:s(()=>[e(t(d),{slot:"icon-only",icon:t(nt)},null,8,["icon"])]),_:1}),e(t(ot),{"is-open":c.value,event:o.value,onDidDismiss:i[1]||(i[1]=y=>c.value=!1)},{default:s(()=>[e(mt)]),_:1},8,["is-open","event"])]),_:1})]),_:1},8,["class"]),e(t(L),{class:A(["header-transition",{"search-bar-persist":p.isHeaderHidden}])},{default:s(()=>[e(t(lt),{"show-clear-button":"focus",class:"searchbar",id:"searchbar",onKeyup:r})]),_:1},8,["class"])]),_:1}))}});export{ht as _};
